<%- model_class = MonthlyStat.new.class -%>
<h2><%=t '.title', :default => model_class.model_name.human.pluralize %></h2>

<table class="table table-striped table-bordered table-condensed">
  <thead>
    <tr>
      <th></th>
      <th colspan="12">
        <%= @year %>
      </th>
    </tr>
    <tr>
      <th></th>
      <%- (1...13).each do |m| -%>
        <th>
          <%= Date::MONTHNAMES[m] %>
        </th>
      <%- end -%>
    </tr>
  </thead>
  <tbody>
  <%- @monthly_stats.each_pair do |name, stats| -%>
    <tr>
      <th><%= name %></th>
      <%- (1...13).each do |month| -%>
        <td>
          <%= monthly_stat = stats[month]
              monthly_stat.try :value %>
          <%- if monthly_stat && @school -%>
            <%= link_to('e',
                        edit_school_monthly_stat_path([@school,monthly_stat]), :class => 'pictos') if can?(:edit,monthly_stat) %>
            <%= link_to('d',
                        school_monthly_stat_path([@school,monthly_stat]),
                        :method => :delete,
                        :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')),
                        :class => 'pictos red') if can?(:destroy,monthly_stat) %>
          <%- end -%>
        </td>
    <%- end -%>
    </tr>
  <%- end -%>
  </tbody>
</table>
