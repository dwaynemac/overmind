<%- model_class = MonthlyStat.new.class -%>
<h2><%=t '.title', :default => model_class.model_name.human.pluralize %></h2>

<table class="table table-striped table-bordered table-condensed">
  <thead>
    <tr>
      <th></th>
      <th colspan="12">
        <%= @year %>
      </th>
    </tr>
    <tr>
      <th></th>
      <%- (1...13).each do |m| -%>
        <th>
          <%= Date::MONTHNAMES[m] %>
        </th>
      <%- end -%>
    </tr>
  </thead>
  <tbody>
  <%- MonthlyStat::VALID_NAMES.each do |name| -%>
    <tr>
      <th><%= name %></th>
      <%- (1...13).each do |month| -%>
        <td>
          <%= monthly_stat = @monthly_stats[name][month]
              monthly_stat.try :value %>
          <%- if monthly_stat && @school -%>
            <%= link_to('e',
                        edit_school_monthly_stat_path(school_id: @school.id, id: monthly_stat.id), :class => 'pictos') if can?(:edit,monthly_stat) %>
            <%= link_to('d',
                        school_monthly_stat_path(id: monthly_stat, school_id: @school.id),
                        :method => :delete,
                        :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')),
                        :class => 'pictos red') if can?(:destroy,monthly_stat) %>
          <%- end -%>
        </td>
    <%- end -%>
    </tr>
  <%- end -%>
  </tbody>
</table>
